import{R as h,j as s,u as N,c as I,e as u,r as d,L as f,b as S,f as n,B as g}from"./index-D9AcpMqu.js";import{p as O,S as k}from"./SideNav-mCBdQBu_.js";import{p as v}from"./postAtom-DEgVzU20.js";import{d as x}from"./detailsAtom-Dtq-BU6S.js";import{i as y}from"./imageAtom-EX3fMRaZ.js";import{P as E,m as w}from"./PopupCard-D7E3FFse.js";/* empty css                  */function F(){const e=h(v);return s.jsx("div",{className:"posts-container",children:e.map((t,a)=>s.jsx("div",{className:"single-post",children:s.jsx("img",{src:t.postImage,width:"200px",height:"200px",alt:`Image for post ${t.postId}`})},e.indexOf(t)))})}function U(){const e=h(x);N();let t=I();const{userId:a}=u(),[o,i]=d.useState(!1);return d.useEffect(()=>{localStorage.getItem("userId")!=a?i(!1):i(!0)},[]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"daughter-2",children:[s.jsxs("div",{className:"head",children:[s.jsx("h2",{className:"username",children:e.username}),s.jsx(f,{to:"/profile/edit",className:o?"edit-profile-button":"display-none",state:{background:t},children:"Edit Profile"}),s.jsx("br",{})]}),s.jsx("div",{className:"list",children:s.jsxs("ul",{children:[s.jsxs("li",{className:"show-posts",children:[" ",e.posts," ",s.jsx("br",{})," ",s.jsx("p",{className:"key-details",children:" Posts "})]}),s.jsx(f,{to:`/followers/${a}`,children:s.jsxs("li",{className:"show-followers",children:["  ",e.followers,"  ",s.jsx("br",{})," ",s.jsx("p",{className:"key-details",children:"Followers"})," "]})}),s.jsx(f,{to:`/following/${a}`,children:s.jsxs("li",{className:"show-following",children:["  ",e.following,"  ",s.jsx("br",{}),s.jsx("p",{className:"key-details",children:"Following"})]})})]})})]})})}function C(){const e=h(y);return s.jsx("div",{className:"daughter-1",children:s.jsx("img",{src:e,width:"10.417vw",height:"10.417vw",onError:t=>{t.style.display="none"}})})}S({key:"followAtom",default:!0});function D(){const e=h(x);u();const t=n(v),a=n(y),o=n(x),{userId:i}=u(),[l,r]=d.useState(!1);console.log(i),d.useEffect(()=>{localStorage.getItem("userId")!=i?r(!1):r(!0)},[]);function j(){const c={loggedUser:localStorage.getItem("userId"),userId:i};fetch(`${g}/follow`,{method:"POST",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify(c)}).then(async function(b){await b.json(),b.status==200&&fetch(`${g}/profile`,{method:"POST",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify(c)}).then(async function(P){const p=await P.json();a(p.DP),o(p.details),t(p.posts)})})}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bada-bio",children:[s.jsxs("div",{className:"bio",children:[s.jsxs("div",{className:"name",children:[s.jsx("p",{children:e.name})," ",s.jsx("br",{})]}),s.jsxs("div",{className:"user-bio",children:[s.jsx("p",{children:e.bio})," "]})]}),s.jsxs("div",{className:"acad-details",children:[s.jsx("div",{className:"degree acad",children:e.degree}),s.jsx("div",{className:"subject acad",children:e.department}),s.jsxs("div",{className:"grad-year acad",children:["Class of ",e.gradYear]})]})]}),s.jsxs("div",{className:"profile-buttons-container",children:[s.jsx("button",{type:"button",className:l?"display-none":e.isFollowing?"unfollow-button button-profile":"follow-button button-profile",onClick:j,children:e.isFollowing?"Unfollow":"Follow"}),s.jsx(f,{to:"/chat/"+i,className:l?"display-none":(e.isFollowing,"message-button button-profile"),children:"Message"}),s.jsx("br",{})]})]})}function _(){const e=N();return s.jsx("div",{className:"outer-container",children:s.jsxs(E,{children:[s.jsx("div",{className:"container",children:s.jsxs("div",{className:"details-1",children:[s.jsx(C,{}),s.jsx(U,{}),s.jsx("div",{className:"profile-close-button-div",onClick:()=>e(-1)})]})}),s.jsx(D,{}),s.jsx("hr",{className:"profile-line"}),s.jsx(F,{})]})})}const A={initial:{y:"100vh",opacity:0},animate:{opacity:1,y:0},exit:{y:"100vh"}},R={initial:{opacity:0},animate:{opacity:1,delay:.5},exit:{opacity:0}};function Y(){const e=n(v),t=n(y),a=n(x),{userId:o}=u(),i=N(),l=n(O),r=JSON.parse(localStorage.getItem("userId"));return d.useEffect(()=>{const j={userId:o,loggedUser:r};fetch(`${g}/profile`,{method:"POST",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify(j)}).then(async function(m){const c=await m.json();m.status==200?(t(c.DP),a(c.details),e(c.posts)):m.status==401&&i("/signin")})},[]),d.useEffect(()=>(o==r&&l(!0),()=>{o==r&&l(!1)}),[]),s.jsx(s.Fragment,{children:s.jsxs(w.div,{className:"profile-overlay",variants:R,initial:"initial",animate:"animate",exit:"exit",children:[s.jsx(k,{className:"profile-sidebar"}),s.jsx(w.div,{className:"profile-animate-container",variants:A,children:s.jsx("div",{className:"scrollable-container",children:s.jsx(_,{})})})]})})}export{Y as default};
